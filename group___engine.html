<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>memcachedpublicAPI: Storage Engine API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Storage Engine API</h1>
<p>Most interesting here is to implement <a class="el" href="structengine__interface__v1.html" title="Definition of the first version of the engine interface.">engine_interface_v1</a> for your engine.  
<a href="#_details">More...</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structitem.html">item</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Data common to any <a class="el" href="structitem.html" title="Data common to any item stored in memcached.">item</a> stored in memcached.  <a href="structitem.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structengine__interface.html">engine_interface</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generic opaque data structure for engines.  <a href="structengine__interface.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structengine__interface__v1.html">engine_interface_v1</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Definition of the first version of the engine interface.  <a href="structengine__interface__v1.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engine.html#ga502bebaa798b3401940137a7a16d8fe5">ENGINE_INTERFACE_VERSION</a>&nbsp;&nbsp;&nbsp;1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engine.html#ga11c03b3612747ce345a6ec0c6ccd7893">ITEM_WITH_CAS</a>&nbsp;&nbsp;&nbsp;1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engine.html#gae6cbea0e711f9422c80bf4e6ece3afb6">ITEM_KEY_PTR</a>&nbsp;&nbsp;&nbsp;2</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engine.html#gaf59030959ca179578d3ba848448866eb">ITEM_DATA_PTR</a>&nbsp;&nbsp;&nbsp;4</td></tr>
<tr><td colspan="2"><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engine.html#gae315dc9bbd0d1cb8fbdacca8e31fd20e">rel_time_t</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Time relative to server start.  <a href="#gae315dc9bbd0d1cb8fbdacca8e31fd20e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engine.html#gab8d9bd9ba0b7b765633bf9b6cbd6aa30">ADD_STAT</a> )(const char *key, const uint16_t klen, const char *val, const uint32_t vlen, const void *cookie)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Callback for any function producing stats.  <a href="#gab8d9bd9ba0b7b765633bf9b6cbd6aa30"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engine.html#ga4f952131b9f47d1ad9f4a28290c9c8b0">ADD_RESPONSE</a> )(const void *key, uint16_t keylen, const void *ext, uint8_t extlen, const void *body, uint32_t bodylen, uint8_t datatype, uint16_t status, uint64_t cas, const void *cookie)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Callback for adding a response backet.  <a href="#ga4f952131b9f47d1ad9f4a28290c9c8b0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structengine__interface.html">engine_interface</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engine.html#gada2e804f49f030565b3d87213d10a313">ENGINE_HANDLE</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generic opaque data structure for engines.  <a href="#gada2e804f49f030565b3d87213d10a313"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="group___engine.html#ga2ae886fae640170aa47e2f5fad851942">ENGINE_ERROR_CODE</a>(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engine.html#gac1f994c5da007d36f3a36789b8825663">CREATE_INSTANCE</a> )(uint64_t interface, <a class="el" href="structengine__interface.html">ENGINE_HANDLE</a> **handle)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The signature for the "create_instance" function exported from the module.  <a href="#gac1f994c5da007d36f3a36789b8825663"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structengine__interface__v1.html">engine_interface_v1</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engine.html#ga31b9874f683847a88a7318fbe1556ca2">ENGINE_HANDLE_V1</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Definition of the first version of the engine interface.  <a href="#ga31b9874f683847a88a7318fbe1556ca2"></a><br/></td></tr>
<tr><td colspan="2"><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engine.html#ga2ae886fae640170aa47e2f5fad851942">ENGINE_ERROR_CODE</a> { <br/>
&nbsp;&nbsp;<a class="el" href="group___engine.html#gga2ae886fae640170aa47e2f5fad851942ad5c10635facfa57b4d23b37dc5de73c3">ENGINE_SUCCESS</a> =  0x00, 
<a class="el" href="group___engine.html#gga2ae886fae640170aa47e2f5fad851942a2f712a400c3121c42e2082b75c912da5">ENGINE_KEY_ENOENT</a> =  0x01, 
<a class="el" href="group___engine.html#gga2ae886fae640170aa47e2f5fad851942a80fcc05d0bffde2586a240b03e75c4c6">ENGINE_KEY_EEXISTS</a> =  0x02, 
<a class="el" href="group___engine.html#gga2ae886fae640170aa47e2f5fad851942a561301c14a22433e53f1cbe2d6082323">ENGINE_ENOMEM</a> =  0x03, 
<br/>
&nbsp;&nbsp;<a class="el" href="group___engine.html#gga2ae886fae640170aa47e2f5fad851942a978a54138d02ca14624e3ce751568428">ENGINE_NOT_STORED</a> =  0x04, 
<a class="el" href="group___engine.html#gga2ae886fae640170aa47e2f5fad851942a33b39d8861f1243067e21c3f4cac28ee">ENGINE_EINVAL</a> =  0x05, 
<a class="el" href="group___engine.html#gga2ae886fae640170aa47e2f5fad851942a8269d8b3f2b991157ffe881e399c8e79">ENGINE_ENOTSUP</a> =  0x06, 
<a class="el" href="group___engine.html#gga2ae886fae640170aa47e2f5fad851942a7eb36788d96ba4f334a87c27842d6785">ENGINE_EWOULDBLOCK</a> =  0x07, 
<br/>
&nbsp;&nbsp;<a class="el" href="group___engine.html#gga2ae886fae640170aa47e2f5fad851942a9381fefc09e75ace2d7879b1a9ae870a">ENGINE_E2BIG</a> =  0x08, 
<a class="el" href="group___engine.html#gga2ae886fae640170aa47e2f5fad851942afcdb2411547eaeb01c8eebf3e13a6c6c">ENGINE_WANT_MORE</a> =  0x09, 
<a class="el" href="group___engine.html#gga2ae886fae640170aa47e2f5fad851942a86a31e7fdd6d4015d03238f75c7bd37d">ENGINE_FAILED</a> =  0xff
<br/>
 }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Response codes for engine operations. </p>
 <a href="group___engine.html#ga2ae886fae640170aa47e2f5fad851942">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engine.html#ga319505a6161227851720785676bade01">ENGINE_STORE_OPERATION</a> { <br/>
&nbsp;&nbsp;<a class="el" href="group___engine.html#gga319505a6161227851720785676bade01accfb4a0fba17f4822ae1f255c742afe3">OPERATION_ADD</a> =  1, 
<a class="el" href="group___engine.html#gga319505a6161227851720785676bade01a5662626ceb79917533976176d46e72fa">OPERATION_SET</a>, 
<a class="el" href="group___engine.html#gga319505a6161227851720785676bade01a4d7a993794c148cf0c3ad30271a6ed91">OPERATION_REPLACE</a>, 
<a class="el" href="group___engine.html#gga319505a6161227851720785676bade01aa05f4b18e658a526bf0669e433dfe565">OPERATION_APPEND</a>, 
<br/>
&nbsp;&nbsp;<a class="el" href="group___engine.html#gga319505a6161227851720785676bade01a297f0f42746c0cc2ef547595e8cf9d9c">OPERATION_PREPEND</a>, 
<a class="el" href="group___engine.html#gga319505a6161227851720785676bade01aae1d377f8eb91d018875f2a95b01cff9">OPERATION_CAS</a>
<br/>
 }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Engine storage operations. </p>
 <a href="group___engine.html#ga319505a6161227851720785676bade01">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___engine.html#gae315dc9bbd0d1cb8fbdacca8e31fd20e">rel_time_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engine.html#ga1ff8f68d7b14e73348265f6e1ce933e8">realtime</a> (const time_t exptime)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the relative time for the given time_t value.  <a href="#ga1ff8f68d7b14e73348265f6e1ce933e8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engine.html#gac0d2c2ceff296e9aeceb5d58811b8012">ITEM_get_cas</a> (const <a class="el" href="structitem.html">item</a> *)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the CAS ID from an <a class="el" href="structitem.html" title="Data common to any item stored in memcached.">item</a>.  <a href="#gac0d2c2ceff296e9aeceb5d58811b8012"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engine.html#ga625b514611a2e965f5945d3623aaa00e">ITEM_set_cas</a> (<a class="el" href="structitem.html">item</a> *, uint64_t)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the CAS id on an <a class="el" href="structitem.html" title="Data common to any item stored in memcached.">item</a>.  <a href="#ga625b514611a2e965f5945d3623aaa00e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engine.html#ga5e73e3731b3b8eec3c6e40a73cb50d17">ITEM_key</a> (const <a class="el" href="structitem.html">item</a> *)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the key from an <a class="el" href="structitem.html" title="Data common to any item stored in memcached.">item</a>.  <a href="#ga5e73e3731b3b8eec3c6e40a73cb50d17"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engine.html#ga6d25447921c853b31fdd9852f72848cf">ITEM_data</a> (const <a class="el" href="structitem.html">item</a> *)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the data from an <a class="el" href="structitem.html" title="Data common to any item stored in memcached.">item</a>.  <a href="#ga6d25447921c853b31fdd9852f72848cf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engine.html#ga2485797b0e4edea9d47cdaf7977c8a0f">ITEM_set_data_ptr</a> (const <a class="el" href="structitem.html">item</a> *, void *)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the location of the data for the given <a class="el" href="structitem.html" title="Data common to any item stored in memcached.">item</a>.  <a href="#ga2485797b0e4edea9d47cdaf7977c8a0f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engine.html#gad16ff47a409662290ca28b2765ce5c1d">notify_io_complete</a> (const void *cookie, <a class="el" href="group___engine.html#ga2ae886fae640170aa47e2f5fad851942">ENGINE_ERROR_CODE</a> status)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Let a connection know that IO has completed.  <a href="#gad16ff47a409662290ca28b2765ce5c1d"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">volatile <a class="el" href="group___engine.html#gae315dc9bbd0d1cb8fbdacca8e31fd20e">rel_time_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engine.html#ga21b2a3d4ff751fe99cdca2d14babc559">current_time</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The current time.  <a href="#ga21b2a3d4ff751fe99cdca2d14babc559"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Most interesting here is to implement <a class="el" href="structengine__interface__v1.html" title="Definition of the first version of the engine interface.">engine_interface_v1</a> for your engine. </p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="ga502bebaa798b3401940137a7a16d8fe5"></a><!-- doxytag: member="engine.h::ENGINE_INTERFACE_VERSION" ref="ga502bebaa798b3401940137a7a16d8fe5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENGINE_INTERFACE_VERSION&nbsp;&nbsp;&nbsp;1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="gaf59030959ca179578d3ba848448866eb"></a><!-- doxytag: member="engine.h::ITEM_DATA_PTR" ref="gaf59030959ca179578d3ba848448866eb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ITEM_DATA_PTR&nbsp;&nbsp;&nbsp;4</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="gae6cbea0e711f9422c80bf4e6ece3afb6"></a><!-- doxytag: member="engine.h::ITEM_KEY_PTR" ref="gae6cbea0e711f9422c80bf4e6ece3afb6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ITEM_KEY_PTR&nbsp;&nbsp;&nbsp;2</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ga11c03b3612747ce345a6ec0c6ccd7893"></a><!-- doxytag: member="engine.h::ITEM_WITH_CAS" ref="ga11c03b3612747ce345a6ec0c6ccd7893" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ITEM_WITH_CAS&nbsp;&nbsp;&nbsp;1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="ga4f952131b9f47d1ad9f4a28290c9c8b0"></a><!-- doxytag: member="engine.h::ADD_RESPONSE" ref="ga4f952131b9f47d1ad9f4a28290c9c8b0" args=")(const void *key, uint16_t keylen, const void *ext, uint8_t extlen, const void *body, uint32_t bodylen, uint8_t datatype, uint16_t status, uint64_t cas, const void *cookie)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* <a class="el" href="group___engine.html#ga4f952131b9f47d1ad9f4a28290c9c8b0">ADD_RESPONSE</a>)(const void *key, uint16_t keylen, const void *ext, uint8_t extlen, const void *body, uint32_t bodylen, uint8_t datatype, uint16_t status, uint64_t cas, const void *cookie)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Callback for adding a response backet. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>key</em>&nbsp;</td><td>The key to put in the response </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>keylen</em>&nbsp;</td><td>The length of the key </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ext</em>&nbsp;</td><td>The data to put in the extended field in the response </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>extlen</em>&nbsp;</td><td>The number of bytes in the ext field </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>body</em>&nbsp;</td><td>The data body </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bodylen</em>&nbsp;</td><td>The number of bytes in the body </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>datatype</em>&nbsp;</td><td>This is currently not used and should be set to 0 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>status</em>&nbsp;</td><td>The status code of the return packet (see in protocol_binary for the legal values) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cas</em>&nbsp;</td><td>The cas to put in the return packet </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cookie</em>&nbsp;</td><td>The cookie provided by the frontend </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="default__engine_8c-example.html#a5">default_engine.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="gab8d9bd9ba0b7b765633bf9b6cbd6aa30"></a><!-- doxytag: member="engine.h::ADD_STAT" ref="gab8d9bd9ba0b7b765633bf9b6cbd6aa30" args=")(const char *key, const uint16_t klen, const char *val, const uint32_t vlen, const void *cookie)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* <a class="el" href="group___engine.html#gab8d9bd9ba0b7b765633bf9b6cbd6aa30">ADD_STAT</a>)(const char *key, const uint16_t klen, const char *val, const uint32_t vlen, const void *cookie)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Callback for any function producing stats. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>key</em>&nbsp;</td><td>the stat's key </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>klen</em>&nbsp;</td><td>length of the key </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>val</em>&nbsp;</td><td>the stat's value in an ascii form (e.g. text form of a number) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>vlen</em>&nbsp;</td><td>length of the value </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cookie</em>&nbsp;</td><td>magic callback cookie </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="default__engine_8c-example.html#a3">default_engine.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="gac1f994c5da007d36f3a36789b8825663"></a><!-- doxytag: member="engine.h::CREATE_INSTANCE" ref="gac1f994c5da007d36f3a36789b8825663" args=")(uint64_t interface, ENGINE_HANDLE **handle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="group___engine.html#ga2ae886fae640170aa47e2f5fad851942">ENGINE_ERROR_CODE</a>(* <a class="el" href="group___engine.html#gac1f994c5da007d36f3a36789b8825663">CREATE_INSTANCE</a>)(uint64_t interface, <a class="el" href="structengine__interface.html">ENGINE_HANDLE</a> **handle)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The signature for the "create_instance" function exported from the module. </p>
<p>This function should fill out an engine inteface structure according to the interface parameter (Note: it is possible to return a lower version number).</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>interface</em>&nbsp;</td><td>The highest interface level the server supports </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Where</em>&nbsp;</td><td>to store the interface handle </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>See description of ENGINE_ERROR_CODE </dd></dl>

</div>
</div>
<a class="anchor" id="gada2e804f49f030565b3d87213d10a313"></a><!-- doxytag: member="engine.h::ENGINE_HANDLE" ref="gada2e804f49f030565b3d87213d10a313" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structengine__interface.html">engine_interface</a>  <a class="el" href="structengine__interface.html">ENGINE_HANDLE</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Generic opaque data structure for engines. </p>

</div>
</div>
<a class="anchor" id="ga31b9874f683847a88a7318fbe1556ca2"></a><!-- doxytag: member="engine.h::ENGINE_HANDLE_V1" ref="ga31b9874f683847a88a7318fbe1556ca2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structengine__interface__v1.html">engine_interface_v1</a>  <a class="el" href="structengine__interface__v1.html">ENGINE_HANDLE_V1</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition of the first version of the engine interface. </p>

</div>
</div>
<a class="anchor" id="gae315dc9bbd0d1cb8fbdacca8e31fd20e"></a><!-- doxytag: member="engine.h::rel_time_t" ref="gae315dc9bbd0d1cb8fbdacca8e31fd20e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint32_t <a class="el" href="group___engine.html#gae315dc9bbd0d1cb8fbdacca8e31fd20e">rel_time_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Time relative to server start. </p>
<p>Smaller than time_t on 64-bit systems. </p>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="default__engine_8c-example.html#a2">default_engine.c</a>.</dd>
</dl>
</div>
</div>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="ga2ae886fae640170aa47e2f5fad851942"></a><!-- doxytag: member="engine.h::ENGINE_ERROR_CODE" ref="ga2ae886fae640170aa47e2f5fad851942" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group___engine.html#ga2ae886fae640170aa47e2f5fad851942">ENGINE_ERROR_CODE</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Response codes for engine operations. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga2ae886fae640170aa47e2f5fad851942ad5c10635facfa57b4d23b37dc5de73c3"></a><!-- doxytag: member="ENGINE_SUCCESS" ref="gga2ae886fae640170aa47e2f5fad851942ad5c10635facfa57b4d23b37dc5de73c3" args="" -->ENGINE_SUCCESS</em>&nbsp;</td><td>
<p>The command executed successfully. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga2ae886fae640170aa47e2f5fad851942a2f712a400c3121c42e2082b75c912da5"></a><!-- doxytag: member="ENGINE_KEY_ENOENT" ref="gga2ae886fae640170aa47e2f5fad851942a2f712a400c3121c42e2082b75c912da5" args="" -->ENGINE_KEY_ENOENT</em>&nbsp;</td><td>
<p>The key does not exists. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga2ae886fae640170aa47e2f5fad851942a80fcc05d0bffde2586a240b03e75c4c6"></a><!-- doxytag: member="ENGINE_KEY_EEXISTS" ref="gga2ae886fae640170aa47e2f5fad851942a80fcc05d0bffde2586a240b03e75c4c6" args="" -->ENGINE_KEY_EEXISTS</em>&nbsp;</td><td>
<p>The key already exists. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga2ae886fae640170aa47e2f5fad851942a561301c14a22433e53f1cbe2d6082323"></a><!-- doxytag: member="ENGINE_ENOMEM" ref="gga2ae886fae640170aa47e2f5fad851942a561301c14a22433e53f1cbe2d6082323" args="" -->ENGINE_ENOMEM</em>&nbsp;</td><td>
<p>Could not allocate memory. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga2ae886fae640170aa47e2f5fad851942a978a54138d02ca14624e3ce751568428"></a><!-- doxytag: member="ENGINE_NOT_STORED" ref="gga2ae886fae640170aa47e2f5fad851942a978a54138d02ca14624e3ce751568428" args="" -->ENGINE_NOT_STORED</em>&nbsp;</td><td>
<p>The <a class="el" href="structitem.html" title="Data common to any item stored in memcached.">item</a> was not stored. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga2ae886fae640170aa47e2f5fad851942a33b39d8861f1243067e21c3f4cac28ee"></a><!-- doxytag: member="ENGINE_EINVAL" ref="gga2ae886fae640170aa47e2f5fad851942a33b39d8861f1243067e21c3f4cac28ee" args="" -->ENGINE_EINVAL</em>&nbsp;</td><td>
<p>Invalid arguments. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga2ae886fae640170aa47e2f5fad851942a8269d8b3f2b991157ffe881e399c8e79"></a><!-- doxytag: member="ENGINE_ENOTSUP" ref="gga2ae886fae640170aa47e2f5fad851942a8269d8b3f2b991157ffe881e399c8e79" args="" -->ENGINE_ENOTSUP</em>&nbsp;</td><td>
<p>The engine does not support this. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga2ae886fae640170aa47e2f5fad851942a7eb36788d96ba4f334a87c27842d6785"></a><!-- doxytag: member="ENGINE_EWOULDBLOCK" ref="gga2ae886fae640170aa47e2f5fad851942a7eb36788d96ba4f334a87c27842d6785" args="" -->ENGINE_EWOULDBLOCK</em>&nbsp;</td><td>
<p>This would cause the engine to block. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga2ae886fae640170aa47e2f5fad851942a9381fefc09e75ace2d7879b1a9ae870a"></a><!-- doxytag: member="ENGINE_E2BIG" ref="gga2ae886fae640170aa47e2f5fad851942a9381fefc09e75ace2d7879b1a9ae870a" args="" -->ENGINE_E2BIG</em>&nbsp;</td><td>
<p>The data is too big for the engine. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga2ae886fae640170aa47e2f5fad851942afcdb2411547eaeb01c8eebf3e13a6c6c"></a><!-- doxytag: member="ENGINE_WANT_MORE" ref="gga2ae886fae640170aa47e2f5fad851942afcdb2411547eaeb01c8eebf3e13a6c6c" args="" -->ENGINE_WANT_MORE</em>&nbsp;</td><td>
<p>The engine want more data if the frontend have more data available. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga2ae886fae640170aa47e2f5fad851942a86a31e7fdd6d4015d03238f75c7bd37d"></a><!-- doxytag: member="ENGINE_FAILED" ref="gga2ae886fae640170aa47e2f5fad851942a86a31e7fdd6d4015d03238f75c7bd37d" args="" -->ENGINE_FAILED</em>&nbsp;</td><td>
<p>Generic failue. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="ga319505a6161227851720785676bade01"></a><!-- doxytag: member="engine.h::ENGINE_STORE_OPERATION" ref="ga319505a6161227851720785676bade01" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group___engine.html#ga319505a6161227851720785676bade01">ENGINE_STORE_OPERATION</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Engine storage operations. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga319505a6161227851720785676bade01accfb4a0fba17f4822ae1f255c742afe3"></a><!-- doxytag: member="OPERATION_ADD" ref="gga319505a6161227851720785676bade01accfb4a0fba17f4822ae1f255c742afe3" args="" -->OPERATION_ADD</em>&nbsp;</td><td>
<p>Store with add semantics. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga319505a6161227851720785676bade01a5662626ceb79917533976176d46e72fa"></a><!-- doxytag: member="OPERATION_SET" ref="gga319505a6161227851720785676bade01a5662626ceb79917533976176d46e72fa" args="" -->OPERATION_SET</em>&nbsp;</td><td>
<p>Store with set semantics. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga319505a6161227851720785676bade01a4d7a993794c148cf0c3ad30271a6ed91"></a><!-- doxytag: member="OPERATION_REPLACE" ref="gga319505a6161227851720785676bade01a4d7a993794c148cf0c3ad30271a6ed91" args="" -->OPERATION_REPLACE</em>&nbsp;</td><td>
<p>Store with replace semantics. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga319505a6161227851720785676bade01aa05f4b18e658a526bf0669e433dfe565"></a><!-- doxytag: member="OPERATION_APPEND" ref="gga319505a6161227851720785676bade01aa05f4b18e658a526bf0669e433dfe565" args="" -->OPERATION_APPEND</em>&nbsp;</td><td>
<p>Store with append semantics. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga319505a6161227851720785676bade01a297f0f42746c0cc2ef547595e8cf9d9c"></a><!-- doxytag: member="OPERATION_PREPEND" ref="gga319505a6161227851720785676bade01a297f0f42746c0cc2ef547595e8cf9d9c" args="" -->OPERATION_PREPEND</em>&nbsp;</td><td>
<p>Store with prepend semantics. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga319505a6161227851720785676bade01aae1d377f8eb91d018875f2a95b01cff9"></a><!-- doxytag: member="OPERATION_CAS" ref="gga319505a6161227851720785676bade01aae1d377f8eb91d018875f2a95b01cff9" args="" -->OPERATION_CAS</em>&nbsp;</td><td>
<p>Store with set semantics. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga6d25447921c853b31fdd9852f72848cf"></a><!-- doxytag: member="engine.h::ITEM_data" ref="ga6d25447921c853b31fdd9852f72848cf" args="(const item *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* ITEM_data </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structitem.html">item</a> *&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the data from an <a class="el" href="structitem.html" title="Data common to any item stored in memcached.">item</a>. </p>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="default__engine_8c-example.html#a12">default_engine.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="gac0d2c2ceff296e9aeceb5d58811b8012"></a><!-- doxytag: member="engine.h::ITEM_get_cas" ref="gac0d2c2ceff296e9aeceb5d58811b8012" args="(const item *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t ITEM_get_cas </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structitem.html">item</a> *&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the CAS ID from an <a class="el" href="structitem.html" title="Data common to any item stored in memcached.">item</a>. </p>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="default__engine_8c-example.html#a15">default_engine.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="ga5e73e3731b3b8eec3c6e40a73cb50d17"></a><!-- doxytag: member="engine.h::ITEM_key" ref="ga5e73e3731b3b8eec3c6e40a73cb50d17" args="(const item *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* ITEM_key </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structitem.html">item</a> *&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the key from an <a class="el" href="structitem.html" title="Data common to any item stored in memcached.">item</a>. </p>

</div>
</div>
<a class="anchor" id="ga625b514611a2e965f5945d3623aaa00e"></a><!-- doxytag: member="engine.h::ITEM_set_cas" ref="ga625b514611a2e965f5945d3623aaa00e" args="(item *, uint64_t)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ITEM_set_cas </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structitem.html">item</a> *&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set the CAS id on an <a class="el" href="structitem.html" title="Data common to any item stored in memcached.">item</a>. </p>

</div>
</div>
<a class="anchor" id="ga2485797b0e4edea9d47cdaf7977c8a0f"></a><!-- doxytag: member="engine.h::ITEM_set_data_ptr" ref="ga2485797b0e4edea9d47cdaf7977c8a0f" args="(const item *, void *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ITEM_set_data_ptr </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structitem.html">item</a> *&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set the location of the data for the given <a class="el" href="structitem.html" title="Data common to any item stored in memcached.">item</a>. </p>

</div>
</div>
<a class="anchor" id="gad16ff47a409662290ca28b2765ce5c1d"></a><!-- doxytag: member="engine.h::notify_io_complete" ref="gad16ff47a409662290ca28b2765ce5c1d" args="(const void *cookie, ENGINE_ERROR_CODE status)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void notify_io_complete </td>
          <td>(</td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>cookie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group___engine.html#ga2ae886fae640170aa47e2f5fad851942">ENGINE_ERROR_CODE</a>&nbsp;</td>
          <td class="paramname"> <em>status</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Let a connection know that IO has completed. </p>

</div>
</div>
<a class="anchor" id="ga1ff8f68d7b14e73348265f6e1ce933e8"></a><!-- doxytag: member="engine.h::realtime" ref="ga1ff8f68d7b14e73348265f6e1ce933e8" args="(const time_t exptime)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___engine.html#gae315dc9bbd0d1cb8fbdacca8e31fd20e">rel_time_t</a> realtime </td>
          <td>(</td>
          <td class="paramtype">const time_t&nbsp;</td>
          <td class="paramname"> <em>exptime</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the relative time for the given time_t value. </p>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="default__engine_8c-example.html#a16">default_engine.c</a>.</dd>
</dl>
</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="ga21b2a3d4ff751fe99cdca2d14babc559"></a><!-- doxytag: member="engine.h::current_time" ref="ga21b2a3d4ff751fe99cdca2d14babc559" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile <a class="el" href="group___engine.html#gae315dc9bbd0d1cb8fbdacca8e31fd20e">rel_time_t</a> <a class="el" href="group___engine.html#ga21b2a3d4ff751fe99cdca2d14babc559">current_time</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The current time. </p>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="default__engine_8c-example.html#a17">default_engine.c</a>.</dd>
</dl>
</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Fri Nov 20 00:21:43 2009 for memcachedpublicAPI by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
